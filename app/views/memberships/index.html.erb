<div class="page-header">
  <h1><%= @project.name %>: Manage Members</h1>
</div>

<ol class="breadcrumb">
  <li><a href="/projects">Projects</a></li>
  <li><%= link_to @project.name, @project %></li>
  <li class="active">Memberships</li>
</ol>

<% membership = Membership.new %>
<% if @membership !=nil %>
<div class="form-horizontal">
  <div class="form-group">
    <div class="col-sm-6">
      <%= render "shared/errors", model: @membership %>
    </div>
  </div>
</div>
<% end %>
<%= form_for [@project, membership], :html => {:class => "form-inline"} do |f| %>

<div class="col-sm-7 well">
  <div class="form-group">
    <div class= "col-sm-1">
      <%= f.collection_select :user_id, User.all, :id, :full_name,
      {include_blank: "Please select a user"},
      {class: "form-control"}%>
    </div>
  </div>

  <div class="form-group">
    <div class="col-sm-1">
      <%= f.select :role, ["member", "owner"], {}, {class:"form-control"} %>
    </div>
  </div>

  <div class="form-group">
    <%= f.submit "Add New Member", class:"btn btn-primary form-control"%>
  </div>
</div>
<% end %>

<br><br><br>

<% @project.users.each do |user| %>
  <% user.memberships.where(project_id: @project.id).each do |membership| %>
    <%= form_for [@project, membership] do |f| %>
      <div class= "form-horizontal">
        <div class="form-group">
          <div class="col-sm-12">
            <div class="form-inline">
              <div class= "col-sm-2">
                <%= link_to membership.user.full_name, user_path(user) %>
              </div>
            </div>

            <div class="form-inline">
              <div class="col-sm-1">
                <%= f.select :role, ["member", "owner"], {}, {class:"form-control true"} %>
              </div>
            </div>

            <div class="form-inline">
              <div class="col-sm-1">
              <%= f.submit "Update", class:"btn btn-primary"%>
            </div>
            </div>

            <div class ="form-inline">
              <div class="col-sm-6">
                <%= link_to "", project_membership_path(@project, membership), class:"glyphicon glyphicon-remove", method: :delete, data:{confirm: "Are you sure you want to delete this membership?"} %>
              </div>
            </div>

          </div>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
